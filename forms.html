<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Liste de Sélection avec Bootstrap</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-5">
    <div class="row">
        <div class="col-md-6">
            <label for="villeSelect">Sélectionnez une ville :</label>
            <select class="form-control" id="villeSelect">
                <option value="paris">Paris</option>
                <option value="lyon">Lyon</option>
                <option value="marseille">Marseille</option>
                <option value="montpellier">Montpellier</option>
            </select>
            <button class="btn btn-primary mt-2" id="envoyerButton">Envoyer</button> <!-- Bouton "Envoyer" -->
        </div>
    </div>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <h4>Coordonnées :</h4>
            <p id="coordinates"></p>
            <h4>Météo :</h4>
            <p id="weather"></p>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<script>
    $('#envoyerButton').on('click', function() { // Gestionnaire pour le bouton "Envoyer"
        var selectedVille = $('#villeSelect').val();
        var apiUrl = 'https://api-adresse.data.gouv.fr/search/?q=' + selectedVille;

        $.ajax({
            url: apiUrl,
            method: 'GET',
            success: function(data) {
                var latitude = data.features[0].geometry.coordinates[1];
                var longitude = data.features[0].geometry.coordinates[0];
                $('#coordinates').text('Latitude : ' + latitude + ', Longitude : ' + longitude);
                
                var weatherApiUrl = 'https://api.openweathermap.org/data/2.5/weather?lat=' + latitude + '&lon=' + longitude + '&appid=44db16db91ed95ba40b859d2a01c1d96';
                
                $.ajax({
                    url: weatherApiUrl,
                    method: 'GET',
                    success: function(weatherData) {
                        var temperature = (weatherData.main.temp - 273.15).toFixed(1); // Convertir la température en Celsius
                        var description = weatherData.weather[0].description;
                        var windSpeed = weatherData.wind.speed;

                        $('#weather').text('Description : ' + description + ' ' + 'Température : ' + temperature + ' ' + 'Vent : ' + windSpeed);
                    },
                    error: function(error) {
                        console.error('Erreur lors de la requête météo :', error);
                    }
                });
            },
            error: function(error) {
                console.error('Erreur lors de la requête :', error);
            }
        });
    });
</script>

</body>
</html>
